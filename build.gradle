apply plugin: 'java'
apply plugin: 'java-library-distribution'


plugins {
   id 'net.nemerosa.versioning' version '2.6.0'
}
version = versioning.info.display


repositories {
	mavenCentral()
}

dependencies {
	compile group: 'org.apache.mina', name: 'mina-core', version: '2.0.7'
	compile group: 'org.apache.mina', name: 'mina-filter-compression', version: '2.0.7'
	compile group: 'net.sf.trove4j', name: 'trove4j', version: '3.0.+'
	compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.+'

    compile fileTree( dir: 'lib', include: '*.jar' )

	testCompile group: 'junit', name: 'junit', version: '4.+'
	testCompile group: 'org.easymock', name: 'easymock', version: '3.+'
	testCompile group: 'org.mockito', name: 'mockito-core', version: '1.10.+'
}

test {
	systemProperty 'intrepid.lease.duration', '2000'
	systemProperty 'intrepid.lease.prune_interval', '1000'
	systemProperty 'intrepid.local_call_handler.initial_reservation', '10000'
	systemProperty 'intrepid.req_invoke_ack_rate_sec', '1'

	ignoreFailures true
}


jar {
	baseName 'intrepid'
}

task sourcesJar(type: Jar, dependsOn: classes) {
	baseName = 'intrepid'
    classifier = 'sources'
    from sourceSets.main.allSource
}

task javadocJar(type: Jar, dependsOn: javadoc) {
	baseName = 'intrepid'
    classifier = 'javadoc'
    from javadoc.destinationDir
}

artifacts {
    archives sourcesJar
    archives javadocJar
}

distributions {
	main {
		baseName = 'intrepid'
        contents {
	        from ( 'build/libs' ) {
		        include '*sources.jar'
		        include '*javadoc.jar'
	        }
	        from( '.' ) {
		        include 'NOTICE.txt'
		        include 'LICENSE*.txt'
		        include 'README.md'
	        }
        }
	}
}